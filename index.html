<!DOCTYPE html>
<html lang="en">

<head>
	<title>Errand Timer</title>
</head>

<body>
	<h1>How Long Will It Take To Run My Errands?</h1>
	<main role="main">
		<form id="errandForm">
			<label for="start">Start</label>
			<input id="start" type="text" name="enter starting address">
			<label for="errand1">Errand</label>
			<input id="errand1" type="text" name="enter errand address">
			<label for="startTime"></label>
			<input id="submit" type="submit" value="submit">
		</form>
		<div id="results">

		</div>
	</main>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!--<script type="text/javascript" src="app.js"></script>-->
	<script>
	"use strict";

//starts the process
function initMap () {
$(listenInputExecute);
}

//success of response execution - pure
function callBack (response, status) {
  if (status === 'OK') {
    console.log(response);
    alert('ok!');
		processData(response);
		displayData(totalDuration);
  }
  else {alert('error!');}
}

//makes the route request
function route (start,errand1) {
	var request = {
  origin : start,
  destination : start,
  waypoints : errand1,
  optimizeWaypoints: true,
travelMode : 'DRIVING'
}
var directionsService = new google.maps.DirectionsService;
	directionsService.route(request, callBack);

}

//process data function - pure - uses implicit coercion for values
const processData = (data) => {
var totalDuration = 0;
let leg1 = data[0].routes.0.legs.0.duration.text;
let leg2 = data[0].routes.0.legs.1.duration.text;
return totalDuration= leg1 + leg2; }


//displays data to user - impure
const displayData = (totalDuration) => {
$('#results').append('<p> The total duration of your errands is' + totalDuration + ' .</p>');
}

//gets input from user - impure
const getInput = () => {
  $('#errandForm').submit(function () {
    event.preventDefault();
		var errand1= $('#errand1').val()
		var start = $('#start').val();
	return start, errand1;
  });
}

//adds errand to to object - pure
const addErrand = (input) => [{ location : input}]

//is this needed? adds input, invokes route - pure
const listenInputExecute = () => {
getInput();
route(start, addErrand(errand1));
}



	</script>
	<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCndF3UNkH3RVb1fW8S65GmGDyHIso4uB0&callbackcallback=initMap">
	</script>
</body>

</html>