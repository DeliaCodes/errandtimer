<!DOCTYPE html>
<html lang="en">

<head>
	<title>Errand Timer</title>
</head>

<body>
	<h1>How Long Will It Take To Run My Errands?</h1>
	<main role="main">
		<form id="errandForm">
			<label for="start">Start</label>
			<input id="start" type="text" name="enter starting address">
			<label for="errand1">Errand</label>
			<input id="errand1" type="text" name="enter errand address">
			<label for="startTime"></label>
			<input id="submit" type="submit" value="submit">
		</form>
		<div id="results">

		</div>
	</main>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script>
	"use strict";

//starts the process - impure d/t jquery
function initMap () {
$(getInput);
}

//gets input from user - impure
const getInput = () => {
  $('#errandForm').submit(function (event) {
    event.preventDefault();
		var errand1= $('#errand1').val()
		var start = $('#start').val();
		route(start, addErrand(errand1));
  });
}

//adds errand to to object - pure
const addErrand = (input) => [{ location : input}]

//makes the route request - impure d/t the google maps
function route (start,errand1) {
	var request = {
  origin : start,
  destination : start,
  waypoints : errand1,
  optimizeWaypoints: true,
travelMode : 'DRIVING'
}
//does this need to be here? or can this be broken out?
var directionsService = new google.maps.DirectionsService;
	directionsService.route(request, callBack);
}

//success of response execution - impure
function callBack (response, status) {
  if (status === 'OK') {
    console.log(response);
    alert('ok!');
		const totalDuration = processData(response);
		displayData(totalDuration);
  }
  else {alert('error!');}
}

//process data function - pure - uses implicit coercion for values
const processData = (data) => {
let leg1 = data.routes[0].legs[0].duration.text;
let leg2 = data.routes[0].legs[1].duration.text;
console.log(leg1);
return leg1 + leg2; }

//displays data to user - impure
const displayData = (totalDuration) => {
$('#results').append('<p> The total duration of your errands is' + totalDuration + ' .</p>');
}
	</script>
	<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCndF3UNkH3RVb1fW8S65GmGDyHIso4uB0&callback=initMap">
	</script>
</body>

</html>